<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>ECE359 Â· Batch 1 â€” Fundamentals & Image Enhancement (Filters and Transformations)</title>
<link href="https://fonts.googleapis.com/css2?family=Space+Mono:ital,wght@0,400;0,700;1,400&family=Fraunces:opsz,wght@9..144,300;9..144,600;9..144,700&family=DM+Sans:wght@300;400;500&display=swap" rel="stylesheet">
<style>
  :root {
    --bg: #0d0f14;
    --bg2: #13161d;
    --bg3: #1a1e28;
    --card: #1e2330;
    --border: #2a3045;
    --accent: #4fc3f7;
    --accent2: #f97316;
    --accent3: #a78bfa;
    --accent4: #34d399;
    --text: #e2e8f0;
    --muted: #7c8ba1;
    --code-bg: #0a0c12;
    --yellow: #fbbf24;
  }

  * { margin: 0; padding: 0; box-sizing: border-box; }

  body {
    background: var(--bg);
    color: var(--text);
    font-family: 'DM Sans', sans-serif;
    font-size: 15px;
    line-height: 1.75;
    overflow-x: hidden;
  }

  /* â”€â”€ HEADER â”€â”€ */
  header {
    background: linear-gradient(135deg, #0d1520 0%, #0d0f14 50%, #130d1e 100%);
    border-bottom: 1px solid var(--border);
    padding: 3.5rem 2rem 3rem;
    text-align: center;
    position: relative;
    overflow: hidden;
  }
  header::before {
    content: '';
    position: absolute;
    inset: 0;
    background: radial-gradient(ellipse 80% 50% at 50% 0%, rgba(79,195,247,0.08) 0%, transparent 70%);
    pointer-events: none;
  }
  .header-tag {
    display: inline-block;
    font-family: 'Space Mono', monospace;
    font-size: 0.7rem;
    letter-spacing: 0.18em;
    color: var(--accent);
    border: 1px solid rgba(79,195,247,0.3);
    padding: 0.3rem 0.9rem;
    border-radius: 2rem;
    margin-bottom: 1.2rem;
    background: rgba(79,195,247,0.05);
  }
  header h1 {
    font-family: 'Fraunces', serif;
    font-size: clamp(2.2rem, 5vw, 3.6rem);
    font-weight: 700;
    letter-spacing: -0.02em;
    line-height: 1.1;
    background: linear-gradient(135deg, #e2e8f0, #4fc3f7 60%, #a78bfa);
    -webkit-background-clip: text;
    -webkit-text-fill-color: transparent;
    background-clip: text;
    margin-bottom: 0.6rem;
  }
  header .subtitle {
    font-family: 'Space Mono', monospace;
    font-size: 0.85rem;
    color: var(--muted);
    letter-spacing: 0.05em;
  }
  .topics-row {
    display: flex;
    justify-content: center;
    gap: 0.7rem;
    flex-wrap: wrap;
    margin-top: 1.8rem;
  }
  .topic-chip {
    font-family: 'Space Mono', monospace;
    font-size: 0.72rem;
    padding: 0.3rem 0.85rem;
    border-radius: 0.3rem;
    border: 1px solid;
    letter-spacing: 0.05em;
  }
  .chip-blue  { border-color: rgba(79,195,247,0.4); color: var(--accent);  background: rgba(79,195,247,0.07); }
  .chip-orange{ border-color: rgba(249,115,22,0.4); color: var(--accent2); background: rgba(249,115,22,0.07); }
  .chip-purple{ border-color: rgba(167,139,250,0.4);color: var(--accent3); background: rgba(167,139,250,0.07);}
  .chip-green { border-color: rgba(52,211,153,0.4); color: var(--accent4); background: rgba(52,211,153,0.07); }

  /* â”€â”€ LAYOUT â”€â”€ */
  .container { max-width: 960px; margin: 0 auto; padding: 0 1.5rem 4rem; }

  /* â”€â”€ SECTION HEADERS â”€â”€ */
  .section-header {
    display: flex;
    align-items: center;
    gap: 1rem;
    margin: 3.5rem 0 1.5rem;
    padding-bottom: 0.7rem;
    border-bottom: 1px solid var(--border);
  }
  .section-num {
    font-family: 'Space Mono', monospace;
    font-size: 0.7rem;
    color: var(--muted);
    letter-spacing: 0.1em;
    white-space: nowrap;
  }
  .section-title {
    font-family: 'Fraunces', serif;
    font-size: 1.55rem;
    font-weight: 600;
    letter-spacing: -0.01em;
  }
  .accent-line {
    flex: 1;
    height: 1px;
    background: linear-gradient(90deg, var(--border), transparent);
  }

  /* â”€â”€ CARDS â”€â”€ */
  .card {
    background: var(--card);
    border: 1px solid var(--border);
    border-radius: 0.75rem;
    padding: 1.5rem 1.75rem;
    margin-bottom: 1.2rem;
  }
  .card-title {
    font-family: 'Space Mono', monospace;
    font-size: 0.72rem;
    letter-spacing: 0.12em;
    color: var(--accent2);
    margin-bottom: 0.7rem;
    text-transform: uppercase;
  }

  /* â”€â”€ DEFINITION BOXES â”€â”€ */
  .def-box {
    background: linear-gradient(135deg, rgba(79,195,247,0.05), rgba(167,139,250,0.05));
    border: 1px solid rgba(79,195,247,0.2);
    border-left: 3px solid var(--accent);
    border-radius: 0 0.5rem 0.5rem 0;
    padding: 1.1rem 1.4rem;
    margin: 1rem 0;
  }
  .def-box.orange { border-left-color: var(--accent2); border-color: rgba(249,115,22,0.2); background: linear-gradient(135deg, rgba(249,115,22,0.05), transparent); }
  .def-box.purple { border-left-color: var(--accent3); border-color: rgba(167,139,250,0.2); background: linear-gradient(135deg, rgba(167,139,250,0.05), transparent); }
  .def-box.green  { border-left-color: var(--accent4); border-color: rgba(52,211,153,0.2);  background: linear-gradient(135deg, rgba(52,211,153,0.05), transparent); }
  .def-box.yellow { border-left-color: var(--yellow);  border-color: rgba(251,191,36,0.2);  background: linear-gradient(135deg, rgba(251,191,36,0.05), transparent); }

  .def-label {
    font-family: 'Space Mono', monospace;
    font-size: 0.68rem;
    letter-spacing: 0.1em;
    color: var(--accent);
    margin-bottom: 0.4rem;
    text-transform: uppercase;
  }
  .def-box.orange .def-label { color: var(--accent2); }
  .def-box.purple .def-label { color: var(--accent3); }
  .def-box.green  .def-label { color: var(--accent4); }
  .def-box.yellow .def-label { color: var(--yellow);  }

  /* â”€â”€ FORMULA â”€â”€ */
  .formula-block {
    background: var(--code-bg);
    border: 1px solid var(--border);
    border-radius: 0.5rem;
    padding: 1rem 1.5rem;
    margin: 1rem 0;
    font-family: 'Space Mono', monospace;
    font-size: 0.9rem;
    color: var(--accent3);
    overflow-x: auto;
    text-align: center;
    letter-spacing: 0.03em;
  }
  .formula-block .formula-label {
    display: block;
    font-size: 0.65rem;
    color: var(--muted);
    letter-spacing: 0.1em;
    text-transform: uppercase;
    margin-bottom: 0.5rem;
    text-align: left;
  }

  /* â”€â”€ CODE ACCORDION â”€â”€ */
  .code-accordion {
    border: 1px solid var(--border);
    border-radius: 0.75rem;
    overflow: hidden;
    margin: 1.2rem 0;
  }
  .code-trigger {
    display: flex;
    align-items: center;
    gap: 0.9rem;
    background: var(--bg3);
    padding: 0.9rem 1.2rem;
    cursor: pointer;
    border: none;
    width: 100%;
    text-align: left;
    transition: background 0.2s;
    user-select: none;
  }
  .code-trigger:hover { background: #202535; }
  .code-trigger .func-name {
    font-family: 'Space Mono', monospace;
    font-size: 0.85rem;
    color: var(--accent);
    flex: 1;
  }
  .code-trigger .func-desc {
    font-size: 0.8rem;
    color: var(--muted);
  }
  .code-trigger .arrow {
    font-size: 0.65rem;
    color: var(--muted);
    transition: transform 0.25s;
    flex-shrink: 0;
  }
  .code-trigger[aria-expanded="true"] .arrow { transform: rotate(180deg); }
  .code-body {
    display: none;
    background: var(--code-bg);
    border-top: 1px solid var(--border);
  }
  .code-body.open { display: block; }
  pre {
    padding: 1.2rem 1.5rem;
    overflow-x: auto;
    font-family: 'Space Mono', monospace;
    font-size: 0.8rem;
    line-height: 1.65;
  }
  /* Syntax highlight classes */
  .kw  { color: #c792ea; }   /* keyword */
  .fn  { color: #82aaff; }   /* function */
  .st  { color: #c3e88d; }   /* string */
  .cm  { color: #546e7a; font-style: italic; }  /* comment */
  .num { color: #f78c6c; }   /* number */
  .op  { color: #89ddff; }   /* operator/punctuation */
  .var { color: var(--text); }
  .builtin { color: var(--accent4); }

  /* â”€â”€ FUNCTION REFERENCE PILL â”€â”€ */
  .fn-pill {
    display: inline-block;
    font-family: 'Space Mono', monospace;
    font-size: 0.72rem;
    background: rgba(130,170,255,0.12);
    border: 1px solid rgba(130,170,255,0.25);
    color: #82aaff;
    padding: 0.15rem 0.5rem;
    border-radius: 0.25rem;
    cursor: help;
    transition: background 0.15s;
  }
  .fn-pill:hover { background: rgba(130,170,255,0.22); }

  /* â”€â”€ EXERCISE BLOCK â”€â”€ */
  .exercise {
    background: linear-gradient(135deg, rgba(249,115,22,0.06), rgba(251,191,36,0.04));
    border: 1px solid rgba(249,115,22,0.25);
    border-radius: 0.75rem;
    padding: 1.5rem 1.75rem;
    margin: 1.5rem 0;
  }
  .exercise-header {
    display: flex;
    align-items: center;
    gap: 0.8rem;
    margin-bottom: 1rem;
  }
  .ex-badge {
    font-family: 'Space Mono', monospace;
    font-size: 0.68rem;
    letter-spacing: 0.1em;
    background: var(--accent2);
    color: #000;
    padding: 0.2rem 0.6rem;
    border-radius: 0.25rem;
    font-weight: 700;
    text-transform: uppercase;
  }
  .exercise-title {
    font-family: 'Fraunces', serif;
    font-size: 1.05rem;
    font-weight: 600;
  }
  .hint-box {
    background: rgba(52,211,153,0.06);
    border: 1px solid rgba(52,211,153,0.2);
    border-radius: 0.4rem;
    padding: 0.8rem 1rem;
    margin-top: 1rem;
  }
  .hint-label {
    font-family: 'Space Mono', monospace;
    font-size: 0.68rem;
    color: var(--accent4);
    letter-spacing: 0.1em;
    margin-bottom: 0.4rem;
    text-transform: uppercase;
  }

  /* â”€â”€ TABLE â”€â”€ */
  .styled-table { width: 100%; border-collapse: collapse; font-size: 0.85rem; margin: 1rem 0; }
  .styled-table th {
    background: var(--bg3);
    color: var(--accent);
    font-family: 'Space Mono', monospace;
    font-size: 0.7rem;
    letter-spacing: 0.08em;
    text-transform: uppercase;
    padding: 0.65rem 1rem;
    border-bottom: 1px solid var(--border);
    text-align: left;
  }
  .styled-table td {
    padding: 0.6rem 1rem;
    border-bottom: 1px solid rgba(42,48,69,0.6);
    vertical-align: top;
  }
  .styled-table tr:last-child td { border-bottom: none; }
  .styled-table td:first-child { font-family: 'Space Mono', monospace; font-size: 0.78rem; color: #82aaff; }

  /* â”€â”€ GRID FORMATS TABLE â”€â”€ */
  .check { color: var(--accent4); } .cross { color: #f87171; }

  /* â”€â”€ FILTER VISUAL â”€â”€ */
  .filter-grid {
    display: inline-grid;
    grid-template-columns: repeat(3, 2.4rem);
    gap: 2px;
    background: var(--border);
    border: 1px solid var(--border);
    border-radius: 0.3rem;
    overflow: hidden;
    margin: 0.5rem 0.5rem 0.5rem 0;
    vertical-align: middle;
  }
  .filter-cell {
    background: var(--code-bg);
    text-align: center;
    padding: 0.4rem 0;
    font-family: 'Space Mono', monospace;
    font-size: 0.78rem;
    color: var(--accent3);
  }
  .filter-cell.hi { background: rgba(79,195,247,0.15); color: var(--accent); }
  .filter-scalar {
    font-family: 'Space Mono', monospace;
    font-size: 0.85rem;
    color: var(--accent2);
    vertical-align: middle;
    margin-right: 0.5rem;
  }

  /* â”€â”€ SCROLL INDICATOR â”€â”€ */
  .toc {
    background: var(--bg2);
    border: 1px solid var(--border);
    border-radius: 0.75rem;
    padding: 1.2rem 1.5rem;
    margin: 2rem 0;
  }
  .toc-title {
    font-family: 'Space Mono', monospace;
    font-size: 0.68rem;
    letter-spacing: 0.12em;
    color: var(--muted);
    text-transform: uppercase;
    margin-bottom: 0.8rem;
  }
  .toc a {
    display: block;
    color: var(--text);
    text-decoration: none;
    padding: 0.2rem 0;
    font-size: 0.88rem;
    transition: color 0.15s;
  }
  .toc a:hover { color: var(--accent); }
  .toc a .toc-num { color: var(--muted); margin-right: 0.5rem; font-family: 'Space Mono', monospace; font-size: 0.75rem; }

  p { margin-bottom: 0.7rem; }
  strong { color: #c9d5e8; font-weight: 500; }
  em { color: var(--accent3); font-style: italic; }

  /* â”€â”€ RESPONSIVE â”€â”€ */
  @media (max-width: 640px) {
    .section-title { font-size: 1.25rem; }
    pre { font-size: 0.72rem; }
    .filter-cell { font-size: 0.68rem; padding: 0.3rem 0; width: 2rem; }
    .filter-grid { grid-template-columns: repeat(3, 2rem); }
  }

  /* â”€â”€ PULSE DOT â”€â”€ */
  .pulse {
    display: inline-block;
    width: 6px; height: 6px;
    border-radius: 50%;
    background: var(--accent4);
    box-shadow: 0 0 0 0 rgba(52,211,153,0.4);
    animation: pulse 2s infinite;
    vertical-align: middle;
    margin-right: 0.5rem;
  }
  @keyframes pulse {
    0%  { box-shadow: 0 0 0 0 rgba(52,211,153,0.4); }
    70% { box-shadow: 0 0 0 6px rgba(52,211,153,0); }
    100%{ box-shadow: 0 0 0 0 rgba(52,211,153,0); }
  }
</style>
</head>
<body>

<!-- â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• HEADER â•â• -->
<header>
  <div class="header-tag">ECE359 Â· Spring 2026 Â· Ain Shams University</div>
  <h1>Lab 1& 2 â€” Fundamentals & Image Enhancement</h1>
  <h2>TA: Adnan Zahran</h2>
  <p class="subtitle">Digital Image Processing for Multimedia &nbsp;Â·&nbsp; Communications Systems Engineering</p>
  <div class="topics-row">
    <span class="topic-chip chip-blue">Pointwise Operations</span>
    <span class="topic-chip chip-orange">Image Histograms</span>
    <span class="topic-chip chip-purple">Histogram Equalization</span>
    <span class="topic-chip chip-green">Spatial Filtering</span>
  </div>
</header>

<div class="container">

<!-- TOC -->
<div class="toc">
  <div class="toc-title">Contents</div>
  <a href="#sec-matlab"><span class="toc-num">01</span> Image Processing in MATLAB â€” Fundamentals</a>
  <a href="#sec-pointwise"><span class="toc-num">02</span> Pointwise Operations &amp; Transformations</a>
  <a href="#sec-histogram"><span class="toc-num">03</span> Image Histograms</a>
  <a href="#sec-histeq"><span class="toc-num">04</span> Histogram Equalization &amp; Matching</a>
  <a href="#sec-spatial"><span class="toc-num">05</span> Spatial Domain Filtering</a>
</div>

<!-- â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
     SECTION 1 â€” MATLAB FUNDAMENTALS
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• -->
<div id="sec-matlab" class="section-header">
  <span class="section-num">01</span>
  <h2 class="section-title">Image Processing in MATLAB</h2>
  <div class="accent-line"></div>
</div>

<p>In MATLAB, every image is stored as a <strong>matrix</strong> where each element holds the intensity value of one pixel. Understanding the image's <em>type</em>, <em>data class</em>, and <em>coordinate system</em> is essential before performing any processing.</p>

<!-- Image Types -->
<div class="card">
  <div class="card-title">Image Types</div>
  <table class="styled-table">
    <tr><th>Type</th><th>Description</th><th>Matrix Shape</th><th>Pixel Values</th></tr>
    <tr><td>Binary</td><td>Two-valued logical image â€” black or white pixels only</td><td>M Ã— N logical</td><td>0 or 1</td></tr>
    <tr><td>Grayscale</td><td>Single channel; each pixel is one intensity level</td><td>M Ã— N</td><td>See data class</td></tr>
    <tr><td>Truecolor (RGB)</td><td>Three channels (Red, Green, Blue) stacked along the 3rd dimension</td><td>M Ã— N Ã— 3</td><td>See data class</td></tr>
  </table>
</div>

<!-- Data Classes -->
<div class="card">
  <div class="card-title">Data Classes &amp; Valid Ranges</div>
  <table class="styled-table">
    <tr><th>Class</th><th>Range</th><th>Bits</th><th>Notes</th></tr>
    <tr><td>uint8</td><td>[0, 255]</td><td>8-bit unsigned</td><td>Most common for 8-bit images</td></tr>
    <tr><td>uint16</td><td>[0, 65535]</td><td>16-bit unsigned</td><td>Medical / scientific images</td></tr>
    <tr><td>double</td><td>[0, 1] <em>(for display)</em></td><td>64-bit float</td><td>MATLAB expects [0,1]; use <span class="fn-pill">im2double</span> to convert safely</td></tr>
    <tr><td>logical</td><td>0 or 1</td><td>1-bit</td><td>Binary images only</td></tr>
  </table>

  <div class="def-box yellow">
    <div class="def-label">âš ï¸ Critical Rule</div>
    When working with <strong>double</strong> images, MATLAB's display functions (<span class="fn-pill">imshow</span>) expect values in <strong>[0, 1]</strong>. Values outside this range will be clipped. Always use <span class="fn-pill">im2double</span> (which divides by 255 automatically) rather than <span class="fn-pill">double()</span> (which merely casts the type without rescaling).
  </div>
</div>

<!-- MATLAB Format Compatibility Table -->
<div class="card">
  <div class="card-title">Format Compatibility</div>
  <table class="styled-table">
    <tr><th>Image Type</th><th>double</th><th>uint16</th><th>uint8</th><th>logical</th></tr>
    <tr><td>Grayscale</td><td><span class="check">âœ“</span> (must be [0,1])</td><td><span class="check">âœ“</span></td><td><span class="check">âœ“</span></td><td><span class="cross">âœ—</span></td></tr>
    <tr><td>RGB</td><td><span class="check">âœ“</span> (must be [0,1])</td><td><span class="check">âœ“</span></td><td><span class="check">âœ“</span></td><td><span class="cross">âœ—</span></td></tr>
    <tr><td>Binary</td><td><span class="cross">âœ—</span></td><td><span class="cross">âœ—</span></td><td><span class="cross">âœ—</span></td><td><span class="check">âœ“</span></td></tr>
  </table>
</div>

<!-- Coordinate Conventions -->
<div class="def-box">
  <div class="def-label">Coordinate Convention</div>
  <p>The origin <strong>(1,1)</strong> is at the <strong>top-left corner</strong>. The first index is the <strong>row</strong> (vertical, downward = increasing x), and the second is the <strong>column</strong> (horizontal, rightward = increasing y). Image size is described as M rows Ã— N columns. MATLAB uses <strong>1-based indexing</strong>, unlike Python's 0-based system.</p>
</div>

<!-- Getting Started Functions -->
<div class="section-header" style="margin-top:2rem;">
  <span class="section-num" style="font-size:0.65rem;">01 Â· A</span>
  <h3 style="font-family:'Fraunces',serif;font-size:1.15rem;font-weight:600;">Core Functions â€” Click to Expand</h3>
  <div class="accent-line"></div>
</div>

<!-- imread -->
<div class="code-accordion">
  <button class="code-trigger" onclick="toggleCode(this)" aria-expanded="false">
    <span class="pulse"></span>
    <span class="func-name">imread( filename )</span>
    <span class="func-desc">Read an image from disk into a MATLAB matrix</span>
    <span class="arrow">â–¼</span>
  </button>
  <div class="code-body">
<pre><span class="cm">% Read an image file â€” MATLAB auto-detects format (JPEG, PNG, BMP, TIFFâ€¦)</span>
<span class="var">I</span> <span class="op">=</span> <span class="fn">imread</span>(<span class="st">'filename.jpg'</span>);

<span class="cm">% Check the resulting size: M rows, N columns, P channels</span>
[<span class="var">M</span>, <span class="var">N</span>, <span class="var">P</span>] <span class="op">=</span> <span class="fn">size</span>(<span class="var">I</span>);  <span class="cm">% P=1 for grayscale, P=3 for RGB</span>

<span class="cm">% Check data class</span>
<span class="fn">class</span>(<span class="var">I</span>)        <span class="cm">% â†’ 'uint8' for most JPEGs</span>
<span class="fn">whos</span> <span class="var">I</span>          <span class="cm">% â†’ full variable info (class, size, bytes)</span></pre>
    <div style="padding:0 1.5rem 1rem;">
      <div class="def-box green" style="margin-top:0;">
        <div class="def-label">What to remember</div>
        <p><span class="fn-pill">imread</span> returns a <strong>uint8</strong> array for standard 8-bit images (values 0â€“255). For a color JPEG, you get a 3D array of shape MÃ—NÃ—3. For a grayscale PNG, you get MÃ—N.</p>
      </div>
    </div>
  </div>
</div>
<!-- imshow -->
<div class="code-accordion">
  <button class="code-trigger" onclick="toggleCode(this)" aria-expanded="false">
    <span class="pulse"></span>
    <span class="func-name">imshow( I )</span>
    <span class="func-desc">Display an image in a figure window</span>
    <span class="arrow">â–¼</span>
  </button>
  <div class="code-body">
<pre><span class="fn">imshow</span>(<span class="var">I</span>);                      <span class="cm">% show uint8 or properly-scaled double</span>
<span class="fn">imshow</span>(<span class="var">I</span>, []);                   <span class="cm">% auto-scale: "MATLAB, you decide what's black and white"</span>
<span class="fn">imshow</span>(<span class="var">I</span>, [<span class="num">150</span> <span class="num">160</span>]);              <span class="cm">% Manual: "150 = pure black, 160 = pure white, everything else in between"</span>

<span class="cm">% Think of [low high] as giving MATLAB a mapping instruction:</span>
<span class="cm">% - Any pixel with value = low (150) â†’ displayed as BLACK</span>
<span class="cm">% - Any pixel with value = high (160) â†’ displayed as WHITE</span>
<span class="cm">% - Everything in between â†’ shades of gray</span>
<span class="cm">% - Values below 150 â†’ also BLACK (clipped)</span>
<span class="cm">% - Values above 160 â†’ also WHITE (clipped)</span>

<span class="cm">% Real-world example with [150 160]:</span>
<span class="cm">%   Pixel value 150 â†’ pure black</span>
<span class="cm">%   Pixel value 155 â†’ medium gray (halfway)</span>
<span class="cm">%   Pixel value 160 â†’ pure white</span>
<span class="cm">%   Pixel value 140 â†’ also black (clipped)</span>
<span class="cm">%   Pixel value 170 â†’ also white (clipped)</span>

<span class="cm">% If I is double but in range [0,255] instead of [0,1], imshow shows white!</span>
<span class="cm">% Fix: either divide by 255, or use im2double, or use imshow(I,[])</span></pre>
    <div style="padding:0 1.5rem 1rem;">
      <div class="def-box yellow" style="margin-top:0;">
        <div class="def-label">Common Pitfall</div>
        <p>If you convert with <span class="fn-pill">double(I)</span> instead of <span class="fn-pill">im2double(I)</span>, pixel values remain in [0,255]. Calling <span class="fn-pill">imshow</span> will display the image as pure white because everything â‰¥ 1 is clipped to white in double mode. Always verify your range.</p>
      </div>
      
      <!-- My friendly addition starts here -->
      <div class="def-box green" style="margin-top:1rem;">
        <div class="def-label">ğŸ¨ Understanding imshow(I, [150 160]) Like a Pro</div>
        <p><strong>imshow(I, [low high])</strong> is like giving MATLAB a translation dictionary:</p>
        <ul style="margin-left:1.2rem; color:var(--text);">
          <li><strong>low (150)</strong> = "Whatever number I put here, show it as BLACK"</li>
          <li><strong>high (160)</strong> = "Whatever number I put here, show it as WHITE"</li>
          <li><strong>Everything in between</strong> = "Show as shades of gray"</li>
          <li><strong>Below 150</strong> = "Also black (can't get darker than black!)"</li>
          <li><strong>Above 160</strong> = "Also white (can't get brighter than white!)"</li>
        </ul>
        <p style="margin-top:0.8rem;"><strong>Example with [150 160]:</strong><br>
        â†’ Pixels with value <strong>150</strong> become <span style="color:white; background:black; padding:0.1rem 0.5rem;">â¬¤ BLACK</span><br>
        â†’ Pixels with value <strong>155</strong> become <span style="color:#888; background:#888; padding:0.1rem 0.5rem;">â¬¤ MEDIUM GRAY</span><br>
        â†’ Pixels with value <strong>160</strong> become <span style="color:black; background:white; padding:0.1rem 0.5rem; border:1px solid gray;">â¬¤ WHITE</span><br>
        â†’ Pixels with value <strong>140</strong> become <span style="color:white; background:black; padding:0.1rem 0.5rem;">â¬¤ ALSO BLACK</span> (clipped)<br>
        â†’ Pixels with value <strong>170</strong> become <span style="color:black; background:white; padding:0.1rem 0.5rem; border:1px solid gray;">â¬¤ ALSO WHITE</span> (clipped)</p>
        <p style="margin-top:0.8rem; background:rgba(79,195,247,0.1); padding:0.5rem; border-radius:0.3rem;">
        ğŸ’¡ <strong>Pro tip:</strong> When you're not sure about your image's range, use <code>imshow(I, [])</code> and let MATLAB figure it out automatically! It's like saying "MATLAB, find the darkest pixel and call it black, find the brightest pixel and call it white, and stretch everything in between."
        </p>
      </div>
      <!-- My friendly addition ends here -->
      
      <div class="def-box" style="margin-top:1rem;">
        <div class="def-label">ğŸ¯ The Three Ways to Use imshow</div>
        <table style="width:100%; font-size:0.8rem;">
          <tr><th>Command</th><th>What it means</th><th>Best for</th></tr>
          <tr><td><code>imshow(I)</code></td><td>"Show it exactly as is"</td><td>uint8 images or properly scaled [0,1] double</td></tr>
          <tr><td><code>imshow(I, [])</code></td><td>"MATLAB, you choose black & white based on my image's min/max"</td><td>When you want maximum contrast</td></tr>
          <tr><td><code>imshow(I, [150 160])</code></td><td>"I'm the boss: 150 = black, 160 = white"</td><td>When you want to focus on a specific intensity range</td></tr>
        </table>
      </div>
    </div>
  </div>
</div>
<!-- Format Conversion -->
<div class="code-accordion">
  <button class="code-trigger" onclick="toggleCode(this)" aria-expanded="false">
    <span class="pulse"></span>
    <span class="func-name">im2double / im2uint8 / double / uint8</span>
    <span class="func-desc">Convert between data classes â€” understand the difference!</span>
    <span class="arrow">â–¼</span>
  </button>
  <div class="code-body">
<pre><span class="cm">%% uint8  â†’  double  (for arithmetic operations)</span>
<span class="var">Id</span> <span class="op">=</span> <span class="fn">im2double</span>(<span class="var">I</span>);   <span class="cm">% divides by 255 â†’ values in [0,1]  â† RECOMMENDED</span>
<span class="var">Id</span> <span class="op">=</span> <span class="fn">double</span>(<span class="var">I</span>);       <span class="cm">% just type-cast  â†’ values in [0,255] â† careful!</span>

<span class="cm">%% double  â†’  uint8  (before saving or displaying)</span>
<span class="var">Iu</span> <span class="op">=</span> <span class="fn">im2uint8</span>(<span class="var">Id</span>);    <span class="cm">% multiplies by 255, clamps, rounds â† RECOMMENDED</span>
<span class="var">Iu</span> <span class="op">=</span> <span class="fn">uint8</span>(<span class="var">Id</span>);        <span class="cm">% just type-cast  â†’ ok only if Id already in [0,255]</span>

<span class="cm">%% Practical workflow for pointwise operations:</span>
<span class="var">I</span>   <span class="op">=</span> <span class="fn">imread</span>(<span class="st">'img.jpg'</span>);
<span class="var">Id</span>  <span class="op">=</span> <span class="fn">double</span>(<span class="var">I</span>);         <span class="cm">% â†’ [0,255] double, convenient for formula-based ops</span>
<span class="var">out</span> <span class="op">=</span> <span class="num">255</span> <span class="op">-</span> <span class="var">Id</span>;          <span class="cm">% compute your transformation (example: negative)</span>
<span class="fn">imshow</span>(<span class="fn">uint8</span>(<span class="var">out</span>));      <span class="cm">% cast back and display</span></pre>
    <div style="padding:0 1.5rem 1rem;">
      <div class="def-box" style="margin-top:0;">
        <div class="def-label">Rule of Thumb</div>
        <p>When applying transformations with formulas, it is often easiest to work in <strong>uint8 range [0,255] using <span class="fn-pill">double()</span></strong>, write your formula using those values, then cast back with <span class="fn-pill">uint8()</span>. Reserve <span class="fn-pill">im2double</span> for normalized [0,1] calculations (e.g., power law with c=1).</p>
      </div>
    </div>
  </div>
</div>

<!-- Basic Ops -->
<div class="code-accordion">
  <button class="code-trigger" onclick="toggleCode(this)" aria-expanded="false">
    <span class="pulse"></span>
    <span class="func-name">Matrix &amp; Array Operations</span>
    <span class="func-desc">Element-wise arithmetic, indexing, slicing</span>
    <span class="arrow">â–¼</span>
  </button>
  <div class="code-body">
<pre><span class="cm">%% â”€â”€ Indexing â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€</span>
<span class="var">pix</span>  <span class="op">=</span> <span class="var">I</span>(<span class="var">r</span>, <span class="var">c</span>);             <span class="cm">% single pixel at row r, col c</span>
<span class="var">subI</span> <span class="op">=</span> <span class="var">I</span>(<span class="num">1</span><span class="op">:</span><span class="num">10</span>, <span class="num">10</span><span class="op">:</span><span class="num">20</span>);       <span class="cm">% crop a 10Ã—11 region</span>
<span class="var">subI</span> <span class="op">=</span> <span class="var">I</span>(<span class="num">1</span><span class="op">:</span><span class="num">2</span><span class="op">:</span><span class="kw">end</span>, <span class="num">2</span><span class="op">:</span><span class="num">2</span><span class="op">:</span><span class="kw">end</span>);   <span class="cm">% downsample: odd rows, even cols</span>

<span class="cm">%% â”€â”€ Element-wise arithmetic â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€</span>
<span class="var">I</span> <span class="op">=</span> <span class="var">I1</span> <span class="op">+</span> <span class="var">I2</span>;              <span class="cm">% addition (both must be same class or double)</span>
<span class="var">I</span> <span class="op">=</span> <span class="var">I1</span> <span class="op">-</span> <span class="num">10</span>;              <span class="cm">% subtract scalar</span>
<span class="var">I</span> <span class="op">=</span> <span class="var">I1</span> <span class="op">.*</span> <span class="var">I2</span>;             <span class="cm">% element-wise multiply (note the dot!)</span>
<span class="var">I</span> <span class="op">=</span> <span class="var">I1</span> <span class="op">./</span> <span class="num">255</span>;            <span class="cm">% divide by scalar â†’ normalize to [0,1]</span>
<span class="var">I</span> <span class="op">=</span> <span class="var">I1</span> <span class="op">.^</span> <span class="num">0.5</span>;            <span class="cm">% element-wise power (gamma correction)</span>

<span class="cm">%% â”€â”€ Array creation â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€</span>
<span class="var">I</span> <span class="op">=</span> <span class="fn">zeros</span>(<span class="num">100</span>, <span class="num">100</span>);      <span class="cm">% 100Ã—100 black image (double)</span>
<span class="var">I</span> <span class="op">=</span> <span class="fn">ones</span>(<span class="num">5</span>, <span class="num">5</span>);           <span class="cm">% 5Ã—5 matrix of ones (useful for filters)</span>
<span class="var">I</span> <span class="op">=</span> <span class="fn">rand</span>(<span class="num">100</span>, <span class="num">100</span>);       <span class="cm">% 100Ã—100 random image in [0,1]</span>

<span class="cm">%% â”€â”€ Concatenation â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€</span>
<span class="var">I</span> <span class="op">=</span> [<span class="var">I1</span>, <span class="var">I2</span>];              <span class="cm">% side by side (horizontal)</span>
<span class="var">I</span> <span class="op">=</span> [<span class="var">I1</span>; <span class="var">I2</span>];              <span class="cm">% stacked (vertical)</span>

<span class="cm">%% â”€â”€ Color conversion â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€</span>
<span class="var">Ig</span> <span class="op">=</span> <span class="fn">rgb2gray</span>(<span class="var">I_rgb</span>);    <span class="cm">% RGB â†’ grayscale (luminance-weighted average)</span></pre>
  </div>
</div>

<!-- Exercise 1 -->
<div class="exercise">
  <div class="exercise-header">
    <span class="ex-badge">Ex. 1</span>
    <span class="exercise-title">Read, Show, and Save an Image</span>
  </div>
  <p>Read image <code style="color:var(--accent3);">'01.jpg'</code>, display it, then save it as <code style="color:var(--accent3);">'Fisherman.png'</code>.</p>
  <div class="code-accordion" style="margin-top:1rem;">
    <button class="code-trigger" onclick="toggleCode(this)" aria-expanded="false">
      <span class="func-name">Solution</span>
      <span class="func-desc">Click to reveal</span>
      <span class="arrow">â–¼</span>
    </button>
    <div class="code-body">
<pre><span class="var">I</span> <span class="op">=</span> <span class="fn">imread</span>(<span class="st">'01.jpg'</span>);      <span class="cm">% read JPEG image</span>
<span class="fn">imshow</span>(<span class="var">I</span>);                  <span class="cm">% display in figure window</span>
<span class="fn">imwrite</span>(<span class="var">I</span>, <span class="st">'Fisherman.png'</span>); <span class="cm">% save as PNG (lossless)</span></pre>
    </div>
  </div>
  <div class="hint-box">
    <div class="hint-label">ğŸ’¡ Note</div>
    <p>PNG is a lossless format, so re-saving a JPEG as PNG will not lose any more data than was already lost when the JPEG was originally compressed. The file size will be larger.</p>
  </div>
</div>


<!-- â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
     SECTION 2 â€” POINTWISE OPERATIONS
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• -->
<div id="sec-pointwise" class="section-header">
  <span class="section-num">02</span>
  <h2 class="section-title">Pointwise Operations &amp; Transformations</h2>
  <div class="accent-line"></div>
</div>

<p>A <strong>pointwise operation</strong> transforms each pixel independently of its neighbors. The output intensity <em>s</em> depends only on the input intensity <em>r</em> of that same pixel. No spatial context is used.</p>

<div class="formula-block">
  <span class="formula-label">General form</span>
  s = T(r)
</div>

<p>Where <em>r</em> is the input pixel intensity and <em>s</em> is the output. The transformation function T entirely determines the effect: brightening, darkening, contrast manipulation, etc.</p>

<div class="def-box orange">
  <div class="def-label">Transformation 1 â€” Negative (Inversion)</div>
  <p>Reverses the intensity scale: bright pixels become dark and vice versa. Useful for enhancing white details embedded in dark regions (e.g., medical X-ray analysis).</p>
</div>
<div class="formula-block">s = (L âˆ’ 1) âˆ’ r &nbsp;&nbsp;&nbsp;&nbsp; where L = 256 for uint8 images (Lâˆ’1 = 255)</div>

<div class="code-accordion">
  <button class="code-trigger" onclick="toggleCode(this)" aria-expanded="false">
    <span class="pulse"></span>
    <span class="func-name">imcomplement( I )</span>
    <span class="func-desc">Native function for image inversion</span>
    <span class="arrow">â–¼</span>
  </button>
  <div class="code-body">
<pre><span class="var">I</span>   <span class="op">=</span> <span class="fn">imread</span>(<span class="st">'image.jpg'</span>);

<span class="cm">% â”€â”€ Native MATLAB approach â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€</span>
<span class="var">neg_native</span> <span class="op">=</span> <span class="fn">imcomplement</span>(<span class="var">I</span>);

<span class="cm">% â”€â”€ Manual math approach (for understanding) â”€â”€â”€â”€â”€â”€â”€â”€</span>
<span class="var">Id</span>  <span class="op">=</span> <span class="fn">double</span>(<span class="var">I</span>);           <span class="cm">% â†’ [0,255] for arithmetic</span>
<span class="var">neg_manual</span> <span class="op">=</span> <span class="fn">uint8</span>(<span class="num">255</span> <span class="op">-</span> <span class="var">Id</span>); 

<span class="fn">imshow</span>(<span class="var">neg_native</span>);</pre>
  </div>
</div>

<div class="def-box purple">
  <div class="def-label">Transformation 2 â€” Power Law (Gamma Correction)</div>
  <p>Raises each normalized pixel value to a power Î³ (gamma). When Î³ &lt; 1 the image is brightened. When Î³ &gt; 1 the image is darkened. This models the non-linear response of display devices.</p>
</div>
<div class="formula-block">s = c Â· r<sup>Î³</sup> &nbsp;&nbsp;&nbsp;&nbsp; (with r normalized to [0,1] when c = 1)</div>

<div class="code-accordion">
  <button class="code-trigger" onclick="toggleCode(this)" aria-expanded="false">
    <span class="pulse"></span>
    <span class="func-name">imadjust( I, [in_range], [out_range], gamma )</span>
    <span class="func-desc">Native function for gamma correction</span>
    <span class="arrow">â–¼</span>
  </button>
  <div class="code-body">
<pre><span class="var">I</span>  <span class="op">=</span> <span class="fn">imread</span>(<span class="st">'image.jpg'</span>);

<span class="cm">% â”€â”€ Native MATLAB approach â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€</span>
<span class="cm">% Empty brackets [] mean "use full dynamic range"</span>
<span class="var">pow_native</span> <span class="op">=</span> <span class="fn">imadjust</span>(<span class="var">I</span>, [], [], <span class="num">0.5</span>);

<span class="cm">% â”€â”€ Manual math approach (for understanding) â”€â”€â”€â”€â”€â”€â”€â”€</span>
<span class="var">Id</span> <span class="op">=</span> <span class="fn">im2double</span>(<span class="var">I</span>);         <span class="cm">% â†’ normalized [0,1]</span>
<span class="var">c</span>  <span class="op">=</span> <span class="num">1</span>; <span class="var">gamma</span> <span class="op">=</span> <span class="num">0.5</span>;                 
<span class="var">pow_manual</span> <span class="op">=</span> <span class="var">c</span> <span class="op">.*</span> (<span class="var">Id</span> <span class="op">.^</span> <span class="var">gamma</span>);    

<span class="fn">imshow</span>(<span class="var">pow_native</span>);</pre>
    <div style="padding:0 1.5rem 1rem;">
      <div class="def-box green" style="margin-top:0;">
        <div class="def-label">Intuition</div>
        <p>Think of Î³ as a curve. Î³=1 â†’ straight diagonal (no change). Î³=0.5 â†’ curve bowing upward â†’ lifts dark pixels up â†’ brighter image. Î³=2 â†’ curve bowing downward â†’ pushes mid-tones down â†’ darker, more contrast.</p>
      </div>
    </div>
  </div>
</div>

<div class="def-box green">
  <div class="def-label">Transformation 3 â€” Logarithmic</div>
  <p>Maps pixel values through a logarithm. This <strong>compresses the dynamic range</strong> â€” very bright pixel values are squashed together, while dark pixels are spread out. Classically used to visualize the Fourier spectrum.</p>
</div>
<div class="formula-block">s = c Â· log(1 + r)</div>

<div class="code-accordion">
  <button class="code-trigger" onclick="toggleCode(this)" aria-expanded="false">
    <span class="pulse"></span>
    <span class="func-name">log( X )</span>
    <span class="func-desc">Standard mathematical logarithm function</span>
    <span class="arrow">â–¼</span>
  </button>
  <div class="code-body">
<pre><span class="var">I</span>  <span class="op">=</span> <span class="fn">imread</span>(<span class="st">'image.jpg'</span>);
<span class="var">Id</span> <span class="op">=</span> <span class="fn">double</span>(<span class="var">I</span>);             <span class="cm">% work in [0,255] range</span>

<span class="cm">% MATLAB relies on standard math functions for log transforms</span>
<span class="var">c</span>   <span class="op">=</span> <span class="num">15</span>;                   <span class="cm">% scaling constant (tune to get output in ~[0,255])</span>
<span class="var">lg</span>  <span class="op">=</span> <span class="var">c</span> <span class="op">.*</span> <span class="fn">log</span>(<span class="num">1</span> <span class="op">+</span> <span class="var">Id</span>);     <span class="cm">% log of (1+r) avoids log(0)</span>

<span class="fn">imshow</span>(<span class="fn">uint8</span>(<span class="var">lg</span>));          <span class="cm">% cast to uint8 (values > 255 get clipped to 255)</span></pre>
  </div>
</div>

<div class="def-box">
  <div class="def-label">Transformation 4 â€” Contrast Stretching</div>
  <p>A mapping that <strong>compresses both extremes</strong> of the dynamic range and <strong>stretches the mid-tones</strong>. MATLAB natively performs linear stretching, while manual implementation can create a smooth sigmoidal (S-shaped) curve.</p>
</div>
<div class="formula-block">imadjust(I, [low_in high_in], [low_out high_out]) &nbsp;&nbsp;&nbsp;&nbsp; (Native Linear Stretch)<br>s = 1 / (1 + (m / r)<sup>E</sup>) &nbsp;&nbsp;&nbsp;&nbsp; (Manual S-curve)</div>

<div class="code-accordion">
  <button class="code-trigger" onclick="toggleCode(this)" aria-expanded="false">
    <span class="pulse"></span>
    <span class="func-name">imadjust( I )</span>
    <span class="func-desc">Native function for contrast stretching</span>
    <span class="arrow">â–¼</span>
  </button>
  <div class="code-body">
<pre><span class="var">I</span>  <span class="op">=</span> <span class="fn">imread</span>(<span class="st">'image.jpg'</span>);

<span class="cm">% â”€â”€ Native MATLAB Automatic Stretch â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€</span>
<span class="cm">% Automatically saturates the bottom 1% and top 1% of pixels</span>
<span class="var">cs_auto</span> <span class="op">=</span> <span class="fn">imadjust</span>(<span class="var">I</span>);

<span class="cm">% â”€â”€ Native MATLAB Manual Stretch â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€</span>
<span class="cm">% Maps input intensities [0.3 to 0.7] across full [0.0 to 1.0] output</span>
<span class="var">cs_manual</span> <span class="op">=</span> <span class="fn">imadjust</span>(<span class="var">I</span>, [<span class="num">0.3</span> <span class="num">0.7</span>], [<span class="num">0</span> <span class="num">1</span>]);

<span class="cm">% â”€â”€ Manual math approach (S-curve) â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€</span>
<span class="var">Id</span> <span class="op">=</span> <span class="fn">im2double</span>(<span class="var">I</span>);         
<span class="var">m</span> <span class="op">=</span> <span class="num">0.5</span>; <span class="var">E</span> <span class="op">=</span> <span class="num">4</span>;     
<span class="var">cs_math</span> <span class="op">=</span> <span class="num">1</span> <span class="op">./</span> (<span class="num">1</span> <span class="op">+</span> (<span class="var">m</span> <span class="op">./</span> (<span class="var">Id</span> <span class="op">+</span> <span class="fn">eps</span>)) <span class="op">.^</span> <span class="var">E</span>);

<span class="fn">imshow</span>(<span class="var">cs_auto</span>);</pre>
    <div style="padding:0 1.5rem 1rem;">
      <div class="def-box yellow" style="margin-top:0;">
        <div class="def-label">Why eps? (For the math approach)</div>
        <p><span class="fn-pill">eps</span> in MATLAB is the machine epsilon â€” the smallest floating-point difference from 1.0. Adding it to <em>r</em> before division ensures pixels with value 0 don't cause a division-by-zero error.</p>
      </div>
    </div>
  </div>
</div>

<div class="exercise">
  <div class="exercise-header">
    <span class="ex-badge">Ex. 2</span>
    <span class="exercise-title">Four Transformations on a 2Ã—2 Grid</span>
  </div>
  <p>Read <code style="color:var(--accent3);">'05.jpg'</code>. Apply negative, power law (Î³=0.9), and logarithmic (c=15) transformations using MATLAB's <strong>native functions</strong> where available. Display all four images (original + 3 transforms) in a 2Ã—2 subplot grid.</p>
  <div class="code-accordion" style="margin-top:1rem;">
    <button class="code-trigger" onclick="toggleCode(this)" aria-expanded="false">
      <span class="func-name">Solution</span>
      <span class="func-desc">Click to reveal</span>
      <span class="arrow">â–¼</span>
    </button>
    <div class="code-body">
<pre><span class="var">I</span>   <span class="op">=</span> <span class="fn">imread</span>(<span class="st">'05.jpg'</span>);

<span class="cm">% 1. Negative (Native)</span>
<span class="var">neg</span> <span class="op">=</span> <span class="fn">imcomplement</span>(<span class="var">I</span>);

<span class="cm">% 2. Power Law / Gamma (Native)</span>
<span class="var">pow</span> <span class="op">=</span> <span class="fn">imadjust</span>(<span class="var">I</span>, [], [], <span class="num">0.9</span>);

<span class="cm">% 3. Logarithmic (Math)</span>
<span class="var">Id</span>  <span class="op">=</span> <span class="fn">double</span>(<span class="var">I</span>);
<span class="var">lg</span>  <span class="op">=</span> <span class="fn">uint8</span>(<span class="num">15</span> <span class="op">.*</span> <span class="fn">log</span>(<span class="num">1</span> <span class="op">+</span> <span class="var">Id</span>));

<span class="cm">% Plot on 2Ã—2 grid</span>
<span class="fn">figure</span>;
<span class="fn">subplot</span>(<span class="num">2</span>, <span class="num">2</span>, <span class="num">1</span>); <span class="fn">imshow</span>(<span class="var">I</span>);   <span class="fn">title</span>(<span class="st">'Original'</span>);
<span class="fn">subplot</span>(<span class="num">2</span>, <span class="num">2</span>, <span class="num">2</span>); <span class="fn">imshow</span>(<span class="var">neg</span>); <span class="fn">title</span>(<span class="st">'Negative'</span>);
<span class="fn">subplot</span>(<span class="num">2</span>, <span class="num">2</span>, <span class="num">3</span>); <span class="fn">imshow</span>(<span class="var">pow</span>); <span class="fn">title</span>(<span class="st">'Power Law \gamma=0.9'</span>);
<span class="fn">subplot</span>(<span class="num">2</span>, <span class="num">2</span>, <span class="num">4</span>); <span class="fn">imshow</span>(<span class="var">lg</span>);  <span class="fn">title</span>(<span class="st">'Logarithmic c=15'</span>);</pre>
    </div>
  </div>
  <div class="hint-box">
    <div class="hint-label">ğŸ’¡ subplot explained</div>
    <p><span class="fn-pill">subplot(rows, cols, index)</span> divides the figure into a rowsÃ—cols grid and activates panel number <em>index</em> (left-to-right, top-to-bottom). Any subsequent <span class="fn-pill">imshow</span> or <span class="fn-pill">plot</span> call draws into that panel.</p>
  </div>
</div>
<!-- Exercise 2 -->
<div class="exercise">
  <div class="exercise-header">
    <span class="ex-badge">Ex. 2</span>
    <span class="exercise-title">Five Transformations on a 2Ã—3 Grid</span>
  </div>
  <p>Read <code style="color:var(--accent3);">'05.jpg'</code>. Apply negative, power law (Î³=0.9), logarithmic (c=15), and <strong>contrast stretching</strong> transformations using MATLAB's native functions where available. Display all five images (original + 4 transforms) in a 2Ã—3 subplot grid.</p>
  <div class="code-accordion" style="margin-top:1rem;">
    <button class="code-trigger" onclick="toggleCode(this)" aria-expanded="false">
      <span class="func-name">Solution</span>
      <span class="func-desc">Click to reveal</span>
      <span class="arrow">â–¼</span>
    </button>
    <div class="code-body">
<pre><span class="var">I</span>   <span class="op">=</span> <span class="fn">imread</span>(<span class="st">'05.jpg'</span>);

<span class="cm">% 1. Negative (Native)</span>
<span class="var">neg</span> <span class="op">=</span> <span class="fn">imcomplement</span>(<span class="var">I</span>);

<span class="cm">% 2. Power Law / Gamma (Native)</span>
<span class="var">pow</span> <span class="op">=</span> <span class="fn">imadjust</span>(<span class="var">I</span>, [], [], <span class="num">0.9</span>);

<span class="cm">% 3. Logarithmic (Math)</span>
<span class="var">Id</span>  <span class="op">=</span> <span class="fn">double</span>(<span class="var">I</span>);
<span class="var">lg</span>  <span class="op">=</span> <span class="fn">uint8</span>(<span class="num">15</span> <span class="op">.*</span> <span class="fn">log</span>(<span class="num">1</span> <span class="op">+</span> <span class="var">Id</span>));

<span class="cm">% 4. Contrast Stretching (Native)</span>
<span class="var">cs</span>  <span class="op">=</span> <span class="fn">imadjust</span>(<span class="var">I</span>);

<span class="cm">% Plot on 2Ã—3 grid</span>
<span class="fn">figure</span>;
<span class="fn">subplot</span>(<span class="num">2</span>, <span class="num">3</span>, <span class="num">1</span>); <span class="fn">imshow</span>(<span class="var">I</span>);   <span class="fn">title</span>(<span class="st">'Original'</span>);
<span class="fn">subplot</span>(<span class="num">2</span>, <span class="num">3</span>, <span class="num">2</span>); <span class="fn">imshow</span>(<span class="var">neg</span>); <span class="fn">title</span>(<span class="st">'Negative'</span>);
<span class="fn">subplot</span>(<span class="num">2</span>, <span class="num">3</span>, <span class="num">3</span>); <span class="fn">imshow</span>(<span class="var">pow</span>); <span class="fn">title</span>(<span class="st">'Power Law \gamma=0.9'</span>);
<span class="fn">subplot</span>(<span class="num">2</span>, <span class="num">3</span>, <span class="num">4</span>); <span class="fn">imshow</span>(<span class="var">lg</span>);  <span class="fn">title</span>(<span class="st">'Logarithmic c=15'</span>);
<span class="fn">subplot</span>(<span class="num">2</span>, <span class="num">3</span>, <span class="num">5</span>); <span class="fn">imshow</span>(<span class="var">cs</span>);  <span class="fn">title</span>(<span class="st">'Contrast Stretch'</span>);</pre>
    </div>
  </div>
  <div class="hint-box">
    <div class="hint-label">ğŸ’¡ subplot explained</div>
    <p><span class="fn-pill">subplot(rows, cols, index)</span> divides the figure into a rowsÃ—cols grid and activates panel number <em>index</em> (left-to-right, top-to-bottom). Any subsequent <span class="fn-pill">imshow</span> or <span class="fn-pill">plot</span> call draws into that panel.</p>
  </div>
</div>

<!-- â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
     SECTION 3 â€” HISTOGRAMS
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• -->
<div id="sec-histogram" class="section-header">
  <span class="section-num">03</span>
  <h2 class="section-title">Image Histograms</h2>
  <div class="accent-line"></div>
</div>

<p>A histogram gives you a statistical summary of the pixel intensity distribution in an image. By examining it you can quickly diagnose whether an image is too dark, too bright, low-contrast, or well-exposed.</p>

<div class="def-box">
  <div class="def-label">Definition â€” Image Histogram</div>
  <p>The image histogram is a discrete function h(r<sub>k</sub>) = n<sub>k</sub>, where r<sub>k</sub> is the k-th gray level and n<sub>k</sub> is the count of pixels in the image that have exactly that intensity value.</p>
</div>

<div class="formula-block">
  <span class="formula-label">Histogram</span>
  h(r<sub>k</sub>) = n<sub>k</sub> &nbsp;&nbsp;&nbsp; for k = 0, 1, â€¦, Lâˆ’1
</div>

<div class="def-box purple">
  <div class="def-label">Definition â€” Normalized Histogram</div>
  <p>The normalized histogram divides each bin count by the total number of pixels n = MÃ—N. This transforms the histogram into a <strong>probability mass function (PMF)</strong> â€” an estimate of the probability that any randomly chosen pixel has intensity r<sub>k</sub>. All bins sum to 1.</p>
</div>

<div class="formula-block">
  <span class="formula-label">Normalized Histogram (PMF estimate)</span>
  h<sub>n</sub>(r<sub>k</sub>) = h(r<sub>k</sub>) / Î£ h(r<sub>j</sub>) &nbsp;&nbsp; (sum over all j from 0 to Lâˆ’1)
</div>

<div class="def-box green">
  <div class="def-label">Reading a Histogram â€” Practical Interpretation</div>
  <p>If the histogram is concentrated in the <strong>left</strong> (low values), the image is dark/underexposed. If concentrated on the <strong>right</strong>, the image is bright/overexposed. If bunched in a narrow range, the image has low contrast. A well-spread histogram generally indicates good contrast coverage.</p>
</div>

<!-- imhist / bar -->
<div class="code-accordion">
  <button class="code-trigger" onclick="toggleCode(this)" aria-expanded="false">
    <span class="pulse"></span>
    <span class="func-name">imhist / bar</span>
    <span class="func-desc">Compute and plot image histograms</span>
    <span class="arrow">â–¼</span>
  </button>
  <div class="code-body">
<pre><span class="var">I</span> <span class="op">=</span> <span class="fn">imread</span>(<span class="st">'image.jpg'</span>);
<span class="var">I</span> <span class="op">=</span> <span class="fn">rgb2gray</span>(<span class="var">I</span>);           <span class="cm">% histograms are computed on single-channel images</span>

<span class="cm">%% â”€â”€ Using MATLAB's built-in â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€</span>
<span class="var">h</span> <span class="op">=</span> <span class="fn">imhist</span>(<span class="var">I</span>, <span class="num">256</span>);         <span class="cm">% histogram with 256 bins (one per gray level)</span>
<span class="fn">figure</span>; <span class="fn">bar</span>(<span class="num">0</span><span class="op">:</span><span class="num">255</span>, <span class="var">h</span>);       <span class="cm">% bar chart: x-axis = intensity values [0..255]</span>
<span class="fn">xlabel</span>(<span class="st">'Gray Level'</span>); <span class="fn">ylabel</span>(<span class="st">'Count'</span>);

<span class="cm">%% â”€â”€ Normalized histogram (manual) â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€</span>
<span class="var">hn</span> <span class="op">=</span> <span class="var">h</span> <span class="op">/</span> <span class="fn">sum</span>(<span class="var">h</span>);             <span class="cm">% divide by total pixel count â†’ PMF</span>
<span class="fn">bar</span>(<span class="num">0</span><span class="op">:</span><span class="num">255</span>, <span class="var">hn</span>);               <span class="cm">% sum(hn) should equal 1.0</span>

<span class="cm">%% â”€â”€ Manual histogram (without imhist) â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€</span>
<span class="var">L</span>  <span class="op">=</span> <span class="num">256</span>;
<span class="var">h_manual</span> <span class="op">=</span> <span class="fn">zeros</span>(<span class="num">1</span>, <span class="var">L</span>);
<span class="kw">for</span> <span class="var">k</span> <span class="op">=</span> <span class="num">0</span><span class="op">:</span><span class="var">L</span><span class="op">-</span><span class="num">1</span>
    <span class="var">h_manual</span>(<span class="var">k</span><span class="op">+</span><span class="num">1</span>) <span class="op">=</span> <span class="fn">sum</span>(<span class="var">I</span>(<span class="op">:</span>) <span class="op">==</span> <span class="var">k</span>);  <span class="cm">% count pixels equal to k</span>
<span class="kw">end</span>
<span class="cm">% Or vectorized: h_manual = histcounts(double(I(:)), -0.5:255.5);</span></pre>
    <div style="padding:0 1.5rem 1rem;">
      <div class="def-box" style="margin-top:0;">
        <div class="def-label">Why bar(0:255, h) and not bar(h)?</div>
        <p>Without specifying the x-axis support, <span class="fn-pill">bar</span> would use indices 1â€“256 instead of gray level values 0â€“255. Providing <code>0:255</code> ensures the x-axis correctly labels intensity values, making the histogram interpretable.</p>
      </div>
    </div>
  </div>
</div>


<!-- â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
     SECTION 4 â€” HISTOGRAM EQUALIZATION & MATCHING
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• -->
<div id="sec-histeq" class="section-header">
  <span class="section-num">04</span>
  <h2 class="section-title">Histogram Equalization &amp; Matching</h2>
  <div class="accent-line"></div>
</div>

<div class="def-box orange">
  <div class="def-label">Concept â€” Histogram Equalization</div>
  <p>Histogram equalization is an automatic contrast-enhancement technique. It applies a pointwise transformation derived from the image's own cumulative distribution function (CDF). The goal is to produce an output image whose histogram is approximately <strong>uniform</strong> (flat) â€” spreading pixel intensities evenly across the full dynamic range [0, Lâˆ’1].</p>
</div>

<div class="formula-block">
  <span class="formula-label">Equalization Transformation (Cumulative Sum of Normalized Histogram)</span>
  s<sub>k</sub> = (Lâˆ’1) Â· Î£<sub>j=0</sub><sup>k</sup> h<sub>n</sub>(r<sub>j</sub>) &nbsp;&nbsp; = &nbsp;&nbsp; (Lâˆ’1) Â· CDF(r<sub>k</sub>)
</div>

<p>Think of it this way: a pixel at gray level r<sub>k</sub> gets remapped to the new level s<sub>k</sub>, which is proportional to how many pixels are darker than or equal to r<sub>k</sub>. Levels with many pixels get spread apart; sparse levels get compressed. The net effect is a more uniform distribution and better perceived contrast.</p>

<div class="code-accordion">
  <button class="code-trigger" onclick="toggleCode(this)" aria-expanded="false">
    <span class="pulse"></span>
    <span class="func-name">Histogram Equalization â€” Manual Implementation</span>
    <span class="func-desc">Without using histeq() â€” derive the mapping from scratch</span>
    <span class="arrow">â–¼</span>
  </button>
  <div class="code-body">
<pre><span class="var">I</span>  <span class="op">=</span> <span class="fn">imread</span>(<span class="st">'image.jpg'</span>);
<span class="var">I</span>  <span class="op">=</span> <span class="fn">rgb2gray</span>(<span class="var">I</span>);             <span class="cm">% convert to grayscale</span>
<span class="var">L</span>  <span class="op">=</span> <span class="num">256</span>;

<span class="cm">%% Step 1 â€” Compute normalized histogram (PMF)</span>
<span class="var">h</span>  <span class="op">=</span> <span class="fn">imhist</span>(<span class="var">I</span>, <span class="var">L</span>);             <span class="cm">% 256-element count vector</span>
<span class="var">hn</span> <span class="op">=</span> <span class="var">h</span> <span class="op">/</span> <span class="fn">sum</span>(<span class="var">h</span>);               <span class="cm">% normalize â†’ PMF (sums to 1)</span>

<span class="cm">%% Step 2 â€” Compute CDF (cumulative sum)</span>
<span class="var">cdf</span> <span class="op">=</span> <span class="fn">cumsum</span>(<span class="var">hn</span>);              <span class="cm">% CDF: cdf(k) = Pr(pixel â‰¤ kâˆ’1)</span>

<span class="cm">%% Step 3 â€” Create the mapping table T: old intensity â†’ new intensity</span>
<span class="var">T</span> <span class="op">=</span> <span class="fn">round</span>((<span class="var">L</span><span class="op">-</span><span class="num">1</span>) <span class="op">.*</span> <span class="var">cdf</span>);       <span class="cm">% scale CDF to [0, 255] and round</span>

<span class="cm">%% Step 4 â€” Apply mapping to every pixel</span>
<span class="var">Ieq</span> <span class="op">=</span> <span class="var">T</span>(<span class="fn">double</span>(<span class="var">I</span>) <span class="op">+</span> <span class="num">1</span>);       <span class="cm">% +1 because MATLAB is 1-indexed</span>
<span class="var">Ieq</span> <span class="op">=</span> <span class="fn">uint8</span>(<span class="var">Ieq</span>);

<span class="cm">%% Visualize results</span>
<span class="fn">figure</span>;
<span class="fn">subplot</span>(<span class="num">2</span>,<span class="num">2</span>,<span class="num">1</span>); <span class="fn">imshow</span>(<span class="var">I</span>);          <span class="fn">title</span>(<span class="st">'Original'</span>);
<span class="fn">subplot</span>(<span class="num">2</span>,<span class="num">2</span>,<span class="num">2</span>); <span class="fn">bar</span>(<span class="num">0</span><span class="op">:</span><span class="num">255</span>, <span class="var">hn</span>);    <span class="fn">title</span>(<span class="st">'Original Histogram'</span>);
<span class="fn">subplot</span>(<span class="num">2</span>,<span class="num">2</span>,<span class="num">3</span>); <span class="fn">imshow</span>(<span class="var">Ieq</span>);        <span class="fn">title</span>(<span class="st">'Equalized'</span>);
<span class="fn">subplot</span>(<span class="num">2</span>,<span class="num">2</span>,<span class="num">4</span>); <span class="fn">bar</span>(<span class="num">0</span><span class="op">:</span><span class="num">255</span>, <span class="fn">imhist</span>(<span class="var">Ieq</span>)<span class="op">/</span><span class="fn">sum</span>(<span class="fn">imhist</span>(<span class="var">Ieq</span>)));
                <span class="fn">title</span>(<span class="st">'Equalized Histogram (approx. flat)'</span>);</pre>
    <div style="padding:0 1.5rem 1rem;">
      <div class="def-box yellow" style="margin-top:0;">
        <div class="def-label">Why +1 in T(double(I) + 1)?</div>
        <p>MATLAB arrays are 1-indexed. If a pixel has value 0, it should look up <code>T(1)</code>. A pixel with value 255 looks up <code>T(256)</code>. So we add 1 to every pixel value before using it as a table index.</p>
      </div>
    </div>
  </div>
</div>

<!-- Exercise 3 -->
<div class="exercise">
  <div class="exercise-header">
    <span class="ex-badge">Ex. 3</span>
    <span class="exercise-title">Full Histogram Enhancement Pipeline</span>
  </div>
  <p>Load <code style="color:var(--accent3);">'image.jpg'</code>. Without using MATLAB built-in functions, perform: (1) plot the input image, (2) compute and display its histogram, (3) equalize the histogram, (4) apply an additional pointwise transformation to further refine the perceptual result.</p>
  <div class="hint-box">
    <div class="hint-label">ğŸ’¡ Hints &amp; Discussion</div>
    <p>Convert to grayscale first. The equalized image may look "washed out" if the original had a very skewed histogram â€” equalization mathematically maximizes entropy but doesn't always satisfy human visual preferences. Step 4 is where you apply judgment: try a mild power-law (Î³ â‰ˆ 0.8) or a brightness shift to taste.</p>
  </div>
</div>

<!-- Histogram Matching -->
<div class="def-box purple">
  <div class="def-label">Histogram Matching (Specification)</div>
  <p>Histogram equalization always targets a <em>uniform</em> distribution. Histogram matching is a generalization: you specify <em>any</em> target distribution p<sub>z</sub>(z<sub>k</sub>), and the algorithm finds the transformation that maps your image's histogram toward it. This is useful when you want to match the "look" of a reference image.</p>
</div>
<div class="formula-block">
  <span class="formula-label">Two-step process</span>
  s<sub>k</sub> = T(r<sub>k</sub>) = CDF<sub>r</sub>(r<sub>k</sub>) &nbsp;&nbsp; then &nbsp;&nbsp; z<sub>k</sub> = Gâ»Â¹(s<sub>k</sub>) = CDF<sub>z</sub>â»Â¹(s<sub>k</sub>)
</div>

<div class="code-accordion">
  <button class="code-trigger" onclick="toggleCode(this)" aria-expanded="false">
    <span class="pulse"></span>
    <span class="func-name">histeq( I, hist )</span>
    <span class="func-desc">Histogram matching to a target distribution</span>
    <span class="arrow">â–¼</span>
  </button>
  <div class="code-body">
<pre><span class="cm">% Load input image and target histogram from file</span>
<span class="var">I</span> <span class="op">=</span> <span class="fn">imread</span>(<span class="st">'slr.jpg'</span>);
<span class="var">I</span> <span class="op">=</span> <span class="fn">rgb2gray</span>(<span class="var">I</span>);

<span class="fn">load</span>(<span class="st">'hist.mat'</span>);              <span class="cm">% loads variable 'hist' into workspace</span>

<span class="cm">% Perform histogram matching</span>
<span class="cm">% 'hist' must be a 256-element normalized target histogram (sums to 1)</span>
<span class="var">I_matched</span> <span class="op">=</span> <span class="fn">histeq</span>(<span class="var">I</span>, <span class="var">hist</span>);

<span class="cm">% Display side by side</span>
<span class="fn">figure</span>;
<span class="fn">subplot</span>(<span class="num">1</span>,<span class="num">2</span>,<span class="num">1</span>); <span class="fn">imshow</span>(<span class="var">I</span>);         <span class="fn">title</span>(<span class="st">'Input'</span>);
<span class="fn">subplot</span>(<span class="num">1</span>,<span class="num">2</span>,<span class="num">2</span>); <span class="fn">imshow</span>(<span class="var">I_matched</span>);  <span class="fn">title</span>(<span class="st">'Histogram Matched'</span>);</pre>
    <div style="padding:0 1.5rem 1rem;">
      <div class="def-box green" style="margin-top:0;">
        <div class="def-label">histeq with one argument vs. two</div>
        <p><span class="fn-pill">histeq(I)</span> performs standard equalization (uniform target). <span class="fn-pill">histeq(I, hgram)</span> performs matching to the distribution in <code>hgram</code>. The target must be a normalized, 256-element vector summing to 1.</p>
      </div>
    </div>
  </div>
</div>

<!-- Exercise 4 -->
<div class="exercise">
  <div class="exercise-header">
    <span class="ex-badge">Ex. 4</span>
    <span class="exercise-title">Histogram Matching with a Target Distribution</span>
  </div>
  <p>Read <code style="color:var(--accent3);">'slr.jpg'</code>, load <code style="color:var(--accent3);">'hist.mat'</code>, perform histogram matching, and display input and output side by side in a single figure.</p>
</div>


<!-- â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
     SECTION 5 â€” SPATIAL FILTERING
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• -->
<div id="sec-spatial" class="section-header">
  <span class="section-num">05</span>
  <h2 class="section-title">Spatial Domain Filtering</h2>
  <div class="accent-line"></div>
</div>

<p>Unlike pointwise operations, <strong>spatial filters</strong> compute each output pixel from a <em>neighborhood</em> of input pixels. A small window (called the <strong>mask</strong>, <strong>kernel</strong>, or <strong>filter</strong>) slides across the image, and at each position a weighted combination of the covered pixels is computed.</p>

<div class="def-box">
  <div class="def-label">Definition â€” Linear Filter (Convolution)</div>
  <p>A filter is <strong>linear</strong> if the output is a weighted sum of input pixels. This is formally expressed as a <strong>2D convolution</strong> between the image f and the filter kernel h. The kernel has size (2a+1)Ã—(2b+1).</p>
</div>

<div class="formula-block">
  <span class="formula-label">2D Convolution</span>
  g(x,y) = (h â˜… f)(x,y) = Î£<sub>s=âˆ’a</sub><sup>a</sup> Î£<sub>t=âˆ’b</sub><sup>b</sup> h(s,t) Â· f(xâˆ’s, yâˆ’t)
</div>

<div class="formula-block">
  <span class="formula-label">2D Cross-Correlation</span>
  g(x,y) = Î£<sub>s=âˆ’a</sub><sup>a</sup> Î£<sub>t=âˆ’b</sub><sup>b</sup> h(s,t) Â· f(x+s, y+t)
</div>

<div class="def-box yellow">
  <div class="def-label">Convolution vs. Correlation â€” What's the difference?</div>
  <p>Convolution flips the kernel 180Â° before sliding it over the image; correlation does not. For <strong>symmetric kernels</strong> (most common smoothing and blurring filters), the two operations produce identical results. For asymmetric kernels (e.g., edge-detection filters), they differ. MATLAB's <span class="fn-pill">imfilter</span> performs <strong>correlation by default</strong>.</p>
</div>

<!-- Filter Visuals -->
<div class="card">
  <div class="card-title">Averaging Filters (Smoothing)</div>
  <p style="margin-bottom:1rem;">These filters replace each pixel with a (weighted) average of its neighborhood. They reduce noise and blur the image. The kernel coefficients must sum to 1 to preserve the overall brightness (unity DC gain).</p>

  <div style="display:flex; flex-wrap:wrap; align-items:flex-start; gap:2rem;">
    <div>
      <p style="font-family:'Space Mono',monospace; font-size:0.75rem; color:var(--muted); margin-bottom:0.4rem;">Type (a) â€” Box Filter (3Ã—3)</p>
      <span class="filter-scalar">1/9 Ã—</span>
      <div class="filter-grid">
        <div class="filter-cell hi">1</div><div class="filter-cell hi">1</div><div class="filter-cell hi">1</div>
        <div class="filter-cell hi">1</div><div class="filter-cell hi">1</div><div class="filter-cell hi">1</div>
        <div class="filter-cell hi">1</div><div class="filter-cell hi">1</div><div class="filter-cell hi">1</div>
      </div>
      <p style="font-size:0.78rem; color:var(--muted); margin-top:0.4rem;">Uniform weights â€” same contribution from all neighbors</p>
    </div>
    <div>
      <p style="font-family:'Space Mono',monospace; font-size:0.75rem; color:var(--muted); margin-bottom:0.4rem;">Type (b) â€” Gaussian-like (3Ã—3)</p>
      <span class="filter-scalar">1/16 Ã—</span>
      <div class="filter-grid">
        <div class="filter-cell">1</div><div class="filter-cell">2</div><div class="filter-cell">1</div>
        <div class="filter-cell">2</div><div class="filter-cell hi">4</div><div class="filter-cell">2</div>
        <div class="filter-cell">1</div><div class="filter-cell">2</div><div class="filter-cell">1</div>
      </div>
      <p style="font-size:0.78rem; color:var(--muted); margin-top:0.4rem;">Center-weighted â€” closer pixels contribute more</p>
    </div>
  </div>

  <div class="def-box green" style="margin-top:1.2rem;">
    <div class="def-label">Effect of Filter Size</div>
    <p>A larger kernel (e.g., 10Ã—10 vs. 5Ã—5) averages over a wider neighborhood, producing <strong>stronger blurring</strong>. Small details and edges get progressively smeared. Larger kernels also increase computational cost since each output pixel requires more multiply-add operations.</p>
  </div>

  <div class="def-box yellow" style="margin-top:0.8rem;">
    <div class="def-label">What happens without the scaling factor?</div>
    <p>Without dividing by the sum of coefficients (9 for a 3Ã—3 box filter), the filter amplifies pixel values by a factor of 9. The resulting image will be massively overexposed â€” most pixels will saturate at 255, appearing pure white. This is why the normalization factor is critical.</p>
  </div>
</div>

<!-- imfilter -->
<div class="code-accordion">
  <button class="code-trigger" onclick="toggleCode(this)" aria-expanded="false">
    <span class="pulse"></span>
    <span class="func-name">imfilter( I, h, options )</span>
    <span class="func-desc">Apply a 2D filter kernel to an image</span>
    <span class="arrow">â–¼</span>
  </button>
  <div class="code-body">
<pre><span class="cm">% Basic usage</span>
<span class="var">I_out</span> <span class="op">=</span> <span class="fn">imfilter</span>(<span class="var">I</span>, <span class="var">h</span>);

<span class="cm">% With explicit options</span>
<span class="var">I_out</span> <span class="op">=</span> <span class="fn">imfilter</span>(<span class="var">I</span>, <span class="var">h</span>, <span class="st">'corr'</span>, <span class="st">'same'</span>, <span class="st">'replicate'</span>);</pre>
    <div style="padding:0 1.5rem 1rem;">
      <table class="styled-table" style="margin-top:0.5rem;">
        <tr><th>Option Category</th><th>Value</th><th>Meaning</th></tr>
        <tr><td>Filtering mode</td><td><code>'corr'</code></td><td>Cross-correlation (default)</td></tr>
        <tr><td></td><td><code>'conv'</code></td><td>Convolution (flips kernel 180Â°)</td></tr>
        <tr><td>Output size</td><td><code>'same'</code></td><td>Output same size as input (default)</td></tr>
        <tr><td></td><td><code>'full'</code></td><td>Full convolution output (larger)</td></tr>
        <tr><td>Border padding</td><td><code>'replicate'</code></td><td>Pad with edge pixel values</td></tr>
        <tr><td></td><td><code>'symmetric'</code></td><td>Mirror-reflect at borders</td></tr>
        <tr><td></td><td><code>'circular'</code></td><td>Tile/wrap the image</td></tr>
        <tr><td></td><td><code>0</code> (default)</td><td>Pad with zeros (may cause dark borders)</td></tr>
      </table>
    </div>
  </div>
</div>

<!-- fspecial -->
<div class="code-accordion">
  <button class="code-trigger" onclick="toggleCode(this)" aria-expanded="false">
    <span class="pulse"></span>
    <span class="func-name">fspecial( type, parameters )</span>
    <span class="func-desc">Create standard filter kernels</span>
    <span class="arrow">â–¼</span>
  </button>
  <div class="code-body">
<pre><span class="cm">% Average (box) filter â€” equivalent to ones(3)/9</span>
<span class="var">h_avg</span> <span class="op">=</span> <span class="fn">fspecial</span>(<span class="st">'average'</span>, [<span class="num">3</span> <span class="num">3</span>]);

<span class="cm">% Gaussian filter â€” size 5Ã—5, sigma=1.5</span>
<span class="var">h_gauss</span> <span class="op">=</span> <span class="fn">fspecial</span>(<span class="st">'gaussian'</span>, [<span class="num">5</span> <span class="num">5</span>], <span class="num">1.5</span>);

<span class="cm">% Laplacian (for edge detection)</span>
<span class="var">h_lap</span> <span class="op">=</span> <span class="fn">fspecial</span>(<span class="st">'laplacian'</span>, <span class="num">0.5</span>);

<span class="cm">% Sobel (horizontal gradient)</span>
<span class="var">h_sobel</span> <span class="op">=</span> <span class="fn">fspecial</span>(<span class="st">'sobel'</span>);  <span class="cm">% detects horizontal edges</span>

<span class="cm">% Motion blur â€” 9 pixels at 45 degrees</span>
<span class="var">h_motion</span> <span class="op">=</span> <span class="fn">fspecial</span>(<span class="st">'motion'</span>, <span class="num">9</span>, <span class="num">45</span>);</pre>
  </div>
</div>

<!-- Exercise 5 -->
<div class="exercise">
  <div class="exercise-header">
    <span class="ex-badge">Ex. 5</span>
    <span class="exercise-title">Averaging Filters â€” Size Comparison</span>
  </div>
  <p>Load <code style="color:var(--accent3);">'board.jpg'</code>. Without using <span class="fn-pill">fspecial</span>, manually design a 5Ã—5 and a 10Ã—10 box filter. Apply both and compare. Then apply a 5Ã—5 filter <em>without</em> the scaling factor and observe the result.</p>
  <div class="code-accordion" style="margin-top:1rem;">
    <button class="code-trigger" onclick="toggleCode(this)" aria-expanded="false">
      <span class="func-name">Solution</span>
      <span class="func-desc">Click to reveal</span>
      <span class="arrow">â–¼</span>
    </button>
    <div class="code-body">
<pre><span class="var">I</span>  <span class="op">=</span> <span class="fn">imread</span>(<span class="st">'board.jpg'</span>);
<span class="var">I</span>  <span class="op">=</span> <span class="fn">rgb2gray</span>(<span class="var">I</span>);            <span class="cm">% work in grayscale</span>

<span class="cm">%% â”€â”€ Filter 1: 5Ã—5 box (normalized) â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€</span>
<span class="var">h5</span> <span class="op">=</span> <span class="fn">ones</span>(<span class="num">5</span>,<span class="num">5</span>) <span class="op">/</span> <span class="num">25</span>;          <span class="cm">% sum of all elements = 1 â†’ unity DC gain</span>
<span class="var">I5</span> <span class="op">=</span> <span class="fn">imfilter</span>(<span class="var">I</span>, <span class="var">h5</span>);

<span class="cm">%% â”€â”€ Filter 2: 10Ã—10 box (normalized) â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€</span>
<span class="var">h10</span> <span class="op">=</span> <span class="fn">ones</span>(<span class="num">10</span>,<span class="num">10</span>) <span class="op">/</span> <span class="num">100</span>;      <span class="cm">% 10Ã—10 = 100 elements</span>
<span class="var">I10</span> <span class="op">=</span> <span class="fn">imfilter</span>(<span class="var">I</span>, <span class="var">h10</span>);

<span class="cm">%% â”€â”€ Filter 3: 5Ã—5 box WITHOUT scaling â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€</span>
<span class="var">h5_noscale</span> <span class="op">=</span> <span class="fn">ones</span>(<span class="num">5</span>,<span class="num">5</span>);       <span class="cm">% sum = 25, NOT normalized!</span>
<span class="var">I5_ns</span> <span class="op">=</span> <span class="fn">imfilter</span>(<span class="fn">double</span>(<span class="var">I</span>), <span class="var">h5_noscale</span>);
<span class="cm">% Values will be in range [0, 255Ã—25] = [0, 6375] â€” mostly saturated</span>

<span class="fn">figure</span>;
<span class="fn">subplot</span>(<span class="num">2</span>,<span class="num">2</span>,<span class="num">1</span>); <span class="fn">imshow</span>(<span class="var">I</span>);              <span class="fn">title</span>(<span class="st">'Original'</span>);
<span class="fn">subplot</span>(<span class="num">2</span>,<span class="num">2</span>,<span class="num">2</span>); <span class="fn">imshow</span>(<span class="var">I5</span>);             <span class="fn">title</span>(<span class="st">'5Ã—5 Average (blurred)'</span>);
<span class="fn">subplot</span>(<span class="num">2</span>,<span class="num">2</span>,<span class="num">3</span>); <span class="fn">imshow</span>(<span class="var">I10</span>);            <span class="fn">title</span>(<span class="st">'10Ã—10 Average (more blurred)'</span>);
<span class="fn">subplot</span>(<span class="num">2</span>,<span class="num">2</span>,<span class="num">4</span>); <span class="fn">imshow</span>(<span class="fn">uint8</span>(<span class="var">I5_ns</span>));   <span class="fn">title</span>(<span class="st">'5Ã—5 NO scale (saturated white!)'</span>);</pre>
    </div>
  </div>
  <div class="hint-box">
    <div class="hint-label">ğŸ’¡ Key Observations</div>
    <p>The 5Ã—5 filter softens fine details while the 10Ã—10 filter blurs much more aggressively â€” edges become heavily smeared. The un-normalized filter produces an image that is almost entirely white because multiplying by 25 pushes nearly all values well beyond 255, and <span class="fn-pill">uint8()</span> clamps them to 255.</p>
  </div>
</div>

<!-- Footer spacer -->
<div style="margin-top:4rem; padding-top:2rem; border-top:1px solid var(--border); text-align:center;">
  <p style="font-family:'Space Mono',monospace; font-size:0.7rem; color:var(--muted); letter-spacing:0.1em;">ECE359 Â· Ain Shams University Â· Spring 2025 &nbsp;Â·&nbsp; Image Enhancement Lab</p>
</div>

</div><!-- /container -->

<script>
  function toggleCode(btn) {
    const body = btn.nextElementSibling;
    const isOpen = body.classList.contains('open');
    body.classList.toggle('open', !isOpen);
    btn.setAttribute('aria-expanded', String(!isOpen));
  }
</script>
</body>
</html>
